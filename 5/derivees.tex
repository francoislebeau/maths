\documentclass[main.tex]{subfiles}
\begin{document}

\chapter{Dérivées}

\section{Introduction}

L'introduction du concept de dérivée est historiquement importante,
puisqu'elle coïncide avec la naissance de l'analyse mathématique et de la mécanique classique de Newton.
Cette année-là\footnote{%
    L'année 1666 est souvent qualifiée de \emph{miraculeuse} (\emph{annus mirabilis} pour les prétentieux)
    car Newton fait des avancées considérables dans l'étude de
    l'analyse mathématique, la dynamique, l'optique et la gravitation.

    Un autre example d'\emph{annus mirabilis} est l'année 2009 du FC Barcelone.
    Ils ont gagné la Liga, la Coupe, la Super Coupe, la Champions League, la Super Coupe d'Europe et la Coupe du monde des clubs.
    Cet exploit leur permet d'être inconstestablement considéré comme le deuxième plus grand club de football d'Espagne.
},
les mathématiques ont acquis le pouvoir d'exprimer les lois naturelles et de modéliser des situations complexes.

En quelques mots,
la dérivée décrit les variations d'une quantité.
D'un point de vue pragmatique,
elle permet ainsi de définir convenablement des notions cruciales en sciences
telles que la vitesse, l'accélération, la courbure, les densités, et bien d'autres encore.
D'une manière plus subtile et bien plus importante,
la dérivée est le langage des lois de la Nature.
Le moment où Newton introduit les dérivées
et écrit les équations qui gouvernent l'Univers en termes de ces dérivées
est considéré comme l'un des tournants de l'histoire de la pensée humaine.

Lorsque l'on tente de définir la vitesse ou une autre quantité mentionné ci-dessus,
le problème sous-jacent est le même,
à savoir de déterminer les équations des tangente à un graphe.
Le véritable triomphe de la dérivée
est la capacité de déduire les tangentes d'une fonction complexe
depuis les tangentes des fonctions qui la composent
via des règles algébriques simples.

Parmi toutes les applications pratiques de la dérivée,
nous choisissons de nous concentrer sur les problèmes de \emph{croissance} et de \emph{courbure} ou \emph{concavité}.
D'une part,
ce choix est pédagogique car les interprétations géométriques peuvent se faire sur une image figée\footnote{%
    Si nous travaillions avec les vitesses,
    nous aurions besoin d'une vidéo pour illustrer la dépendance temporelle.
}.
D'autre part,
ce point de vue nous permet de résoudre l'une des questions pratiques les plus importantes pour une fonction,
à savoir quand cette dernière atteint une valeur extrémale.

\section{Définition et premières propriétés}

Supposons que nous souhaitons trouver l'inclinaison ou la pente de la \emph{tangente} au graphe d'une fonction $f$ au point $(a, f(a))$,
comme dans le graphique ci-dessous.

\begin{plot}
    {0.5}{-6}{-5}{6}{6}

    % Fonction
    \def\f{1/5*(\x)^2 - 3}
    \def\der{2/5*(\x)}

    \plotfunction{-6:6}{\f}
    \showcoordinates{\f}{2.5}{[above] {$a$}}{[left] {$f(a)$}}
    \drawtangent{\f}{\der}{2.5}{-6:6}
\end{plot}

L'idée est d'approximer la \emph{tangente} en choisissant un point $x \in \dom f \setminus \{a\}$
et en traçant la droite \emph{sécante} passant par $(a, f(a))$ et $(x, f(x))$.

\begin{plot}
    {0.5}{-6}{-5}{6}{6}

    % Fonction
    \def\f{1/5*(\x)^2 - 3}
    \def\der{2/5*(\x)}

    \plotfunction{-6:6}{\f}
    \showcoordinates{\f}{2.5}{[above] {$a$}}{[left] {$f(a)$}}
    \showcoordinates{\f}{4.5}{[below] {$x$}}{[left] {$f(x)$}}
    \drawsecant{\f}{2.5}{4.5}{-6:6}
\end{plot}

Remarquons que la pente de cette sécante est donnée par
\begin{align}
    \frac {f(x) - f(a)} {x - a}.
\end{align}

Lorsque $x$ s'approche de $a$,
on remarque que la sécante s'approche de la tangente.
\begin{plot}
    {0.5}{-6}{-5}{6}{6}

    % Fonction
    \def\f{1/5*(\x)^2 - 3}
    \def\der{2/5*(\x)}

    \plotfunction{-6:6}{\f}
    \drawsecant{\f}{2.5}{3}{-6:6}
\end{plot}

Pour obtenir la \emph{tangente},
on fait tendre $x$ vers $a$,
et la droite résultante a comme pente
\begin{align}
    \lim_{x \to a} \frac {f(x) - f(a)} {x - a}.
\end{align}

\begin{definition}
    [Dérivée]

    \subsubsection*{Cadre}

    \begin{itemize}
        \item $f$ est une fonction;
        \item $a \in \dom f$ est un point \emph{non-isolé} de $\dom f$.
    \end{itemize}

    \subsubsection*{Définition}

    Si la limite
    \begin{align}
        \lim_{x \to a} \frac {f(x) - f(a)} {x - a}
    \end{align}
    existe et est réelle,
    alors le nombre
    \begin{align}
        f'(a) \defeq \lim_{x \to a} \frac {f(x) - f(a)} {x - a}
    \end{align}
    est appelé la \emph{dérivée} de $f$ en $a$.
\end{definition}

\begin{remark}
    [Dérivabilité]

    \begin{itemize}
        \item Nous dirons qu'une fonction $f$ est \textbf{dérivable en $a$}
            si la dérivée de $f$ en $a$ a un sens et existe.
        \item Nous dirons qu'une fonction $f$ est \textbf{dérivable}
            si elle est dérivable en tout point de son domaine.
    \end{itemize}
\end{remark}

\begin{remark}
    Une expression telle que
    \begin{align}
        \frac {f(x) - f(a)} {x - a}
    \end{align}
    est appelée \emph{quotient différentiel}.
    Dans ce langage,
    une dérivée est une limite d'un quotient différentiel.
\end{remark}

\begin{definition}
    [Tangente]

    \subsubsection{Cadre}

    \begin{itemize}
        \item $f$ une fonction dérivable en $a \in \R$.
    \end{itemize}

    \subsubsection{Définition}

    La droite de pente $f'(a)$ passant par $(a, f(a))$,
    dont l'équation est
    \begin{align}
        T_{f, a} \equiv y = f'(a) (x - a) + f(a),
    \end{align}
    est appelée \emph{tangente} de $f$ en $a$.

    \begin{plot}{0.3}{-6}{-4}{6}{6}
        \def\f{-1/5*(\x)^2 + 4}
        \def\der{-2/5*(\x)}
        \plotfunction{-6:6}{\f}
        \drawtangent{\f}{\der}{-3}{-6:6}
        \showcoordinates{\f}{-3}{[below] {$a$}}{[right] {$f(a)$}}
    \end{plot}
\end{definition}

\begin{example}
    [Dérivée d'une constante]

    Soit $k \in \R$ une constante.
    Calculons la dérivée de $f(x) = k$ en un $a \in \R$ quelconque.
    Dans ce but,
    analysons le quotient différentiel
    \begin{align}
        \frac {f(x) - f(a)}{x - a}
        &= \frac {k-k}{x - a}\\
        &= 0.
    \end{align}

    En faisant tendre $x$ vers $a$ des deux côtés,
    on obtient
    \begin{align}
        f'(a) = 0.
    \end{align}

    Ce résultat est évident intuitivement
    puisque la tangente en tout point est exactement $f$,
    et $f$ a une pente nulle.
    \begin{plot}{0.5}{-6}{-1}{6}{3}
        \plotfunction{-6:6}{1}
    \end{plot}
\end{example}

\begin{example}
    [Dérivée de $x$]

    Calculons la dérivée de $f(x) = x$ en un $a \in \R$ quelconque.
    Dans ce but,
    analysons le quotient différentiel
    \begin{align}
        \frac {f(x) - f(a)}{x - a}
        &= \frac {x - a}{x - a}\\
        &= 1.
    \end{align}

    En faisant tendre $x$ vers $a$ des deux côtés,
    on obtient
    \begin{align}
        f'(a) = 1.
    \end{align}

    Ce résultat est évident intuitivement
    puisque la tangente en tout point est exactement $f$,
    et $f$ a une pente égale à $1$.
    \begin{plot}{0.25}{-6}{-6}{6}{6}
        \plotfunction{-6:6}{\x}
    \end{plot}
\end{example}

\begin{example}
    [Dérivée de $x^2$]

    Calculons la dérivée de $f(x) = x^2$ en un $a \in \R$ quelconque.
    Dans ce but,
    analysons le quotient différentiel
    \begin{align}
        \frac {f(x) - f(a)}{x - a}
        &= \frac {x^2 - a^2}{x - a}\\
        &= \frac {(x + a)(x - a)}{x - a}\\
        &= x + a
    \end{align}

    En faisant tendre $x$ vers $a$ des deux côtés,
    on obtient
    \begin{align}
        f'(a) = 2a.
    \end{align}
\end{example}

\begin{example}
    [Dérivée de $x^3$]

    Calculons la dérivée de $f(x) = x^3$ en un $a \in \R$ quelconque.
    Dans ce but,
    analysons le quotient différentiel
    \begin{align}
        \frac {f(x) - f(a)}{x - a}
        &= \frac {x^3 - a^3}{x - a}\\
        &= \frac {(x-a)(x^2 + ax + a^2)}{x - a}\\
        &= x^2 + ax + a^2.
    \end{align}

    En faisant tendre $x$ vers $a$ des deux côtés,
    on obtient
    \begin{align}
        f'(a) = 3a^2.
    \end{align}
\end{example}

On peut extrapoler l'exemple suivant.

\begin{example}
    [Dérivée de $x^n$]

    Soit $n \in \N$.
    Calculons la dérivée de $f(x) = x^n$ en un $a \in \R$ quelconque.
    Dans ce but,
    analysons le quotient différentiel
    \begin{align}
        \frac {f(x) - f(a)}{x - a}
        &= \frac {x^n - a^n}{x - a}\\
        &= \frac {(x-a)(x^{n-1} + ax^{n-2} + a^2x^{n-3} + \cdots + a^{n-2}x + a^{n-1})}{x - a}\\
        &= (x^{n-1} + ax^{n-2} + a^2x^{n-3} + \cdots + a^{n-2}x + a^{n-1}).
    \end{align}

    En faisant tendre $x$ vers $a$ des deux côtés,
    on obtient
    \begin{align}
        f'(a) = na^{n-1}.
    \end{align}
\end{example}

\begin{example}
    [Dérivée de $\sqrt x$]

    Calculons la dérivée de $f(x) = \sqrt x$ en un $a \in \R^+$ quelconque.
    Dans ce but,
    analysons le quotient différentiel
    \begin{align}
        \frac {f(x) - f(a)}{x - a}
        &= \frac {\sqrt x - \sqrt a}{x - a}\\
        &= \frac {\sqrt x - \sqrt a}{x - a} \cdot \frac{\sqrt x + \sqrt a}{\sqrt x + \sqrt a}\\
        &= \frac {{(\sqrt x)}^2 - {(\sqrt a)}^2}{(x - a) (\sqrt x + \sqrt a)}\\
        &= \frac {x - a} {(x - a) (\sqrt x + \sqrt a)}\\
        &= \frac 1 {\sqrt x + \sqrt a}
    \end{align}

    En faisant tendre $x$ vers $a$ des deux côtés,
    on obtient
    \begin{align}
        f'(a) = \frac 1 {2 \sqrt a}
    \end{align}
\end{example}

\begin{example}
    [Dérivée de $\frac 1 x$]

    Calculons la dérivée de $f(x) = \frac 1 x$ en un $a \in \R_0$ quelconque.
    Dans ce but,
    analysons le quotient différentiel
    \begin{align}
        \frac {f(x) - f(a)} h
        &= \frac {\frac 1 x - \frac 1 a}{x - a}\\
        &= \frac{\frac{a - x}{ax}}{x - a}\\
        &= \frac {-1}{ax}
    \end{align}

    En faisant tendre $x$ vers $a$ des deux côtés,
    on obtient
    \begin{align}
        f'(a) = \frac {-1} {a^2}.
    \end{align}
\end{example}

\begin{proposition}
    [Dérivabilité et continuité]

    Soit $f$ une fonction dérivable en $a \in \R$.
    La limite
    \begin{align}
        \lim_{x \to a} f(x)
    \end{align}
    existe et vaut $f(a)$
    (autrement dit, $f$ est \emph{continue} en $a$).
\end{proposition}
\begin{proof}
    Soit $x \in \dom f \setminus \{a\}$.
    On vérifie que
    \begin{align}
        f(x) = \left(\frac {f(x) - f(a)} {x - a}\right) (x - a) + f(a).
    \end{align}

    En faisant tendre $x$ vers $a$ des deux côtés\footnote{%
        Techniquement, on fait tendre $x \to a$ avec la contrainte supplémentaire $x \neq a$.
        En d'autres termes, on calcule une limite \emph{épointée}.
        Il faut ensuite conclure qu'au vu du résultat obtenu (i.e.\ $f(a)$),
        la contrainte peut être levée.
    }
    et en employant les propriétés des limites,
    on obtient
    \begin{align}
        \lim_{x \to a} f(x)
        &= \left(\lim_{x \to a} \frac {f(x) - f(a)} {x - a}\right) \lim_{x \to a} (x - a) + \lim_{x \to a} f(a)\\
        &= f'(a) \cdot 0 + f(a) = f(a).
    \end{align}
\end{proof}

Il faut bien noter que ce résultat est valable seulement dans un sens.
En effet, voici deux exemples qui montrent qu'une fonction peut être \emph{continue} en un point sans être \emph{dérivable} en ce point.

\begin{example}
    [Une fonction continue non dérivable]
    
    Soit $f$ la fonction définie par 
    \begin{align}
        f(x) = |x|
    \end{align}
    
    Un simple regard sur son graphique permet de se convaincre qu'elle est continue partout sur $\R$.
    \begin{plot}{0.5}{-4}{-1}{4}{4}
        \plotfunction{-4:0}{-\x}
        \plotfunction{0:4}{\x}
    \end{plot}
    
    Cependant, on s'aperçoit que la courbe change brusquement de direction en $0$ et qu'il n'y a donc par de tangente à $f$ en ce point/
    La fonction $f$ n'est donc pas dérivable en $0$.
\end{example}

Voici un deuxième exemple.

\begin{example}
    [Une autre fonction continue non dérivable]
    
    Soit $f$ la fonction définie par 
    \begin{align}
        f(x) = \sqrt {x-1}
    \end{align}
    
    Un simple regard sur son graphique permet de se convaincre qu'elle est continue partout sur $\cointerval{1}{+ \infty}$.
    \begin{plot}{0.5}{-2}{-2}{6}{4}
        \plotfunction{1:6}{(\x - 1)^(1/2)}
        \drawline (1,-2)--(1,6);
    \end{plot}
    
    On s'aperçoit également qu'en $0$, la tangente de $f$ est verticale.
    La pente d'une droite verticale n'étant pas un nombre réel, on en conclut que $f$ n'est pas dérivable en $0$.
\end{example}

Le choix de mesurer les angles en radian
(c'est-à-dire une unité où le tour complet est représenté par un nombre \emph{irrationnel}\footnote{%
    Formulé comme ça, ça a quand même l'air d'être une décision vachement stupide.
    En plus, $\pi$ est transcendant, ce qui est le pire type de nombre irrationnel.

    En tant qu'ami de Monsieur Masson (paix à son âme),
    je me vois également moralement obligé de mentionner
    que la valeur de $\pi$ devrait être doublée pour correspondre au tour complet.
})
est justifié par la proposition suivante (admise sans preuve).

\begin{proposition}
    [Dérivée des fonctions trigonométriques en radian]

    Pour tout $x \in \R$,
    nous avons
    \begin{align}
        \sin' x &= \cos x\\
        \cos' x &= -\sin x.
    \end{align}
\end{proposition}

\section{Comportement avec les opérations sur les fonctions}

Une dérivée peut se calculer terme par terme.

\begin{proposition}
    [Dérivée d'une somme]

    Soient $f, g$ deux fonctions dérivables en $a \in \R$.
    Alors $f + g$ est dérivable en $a$ et
    \begin{align}
        (f + g)'(a) = f'(a) + g'(a).
    \end{align}
\end{proposition}
\begin{proof}
    Soit $x \in \dom f \setminus \{a\}$.
    Le quotient différentiel de $f + g$ s'écrit
    \begin{align}
        \frac {(f + g)(x) - (f + g)(a)} {x - a}
        &= \frac {f(x) - f(a)} {x - a} + \frac {g(x) - g(a)} {x - a}.
    \end{align}

    En faisant tendre $x$ vers $a$ des deux côtés,
    on obtient
    \begin{align}
        (f + g)'(a) = f'(a) + g'(a).
    \end{align}
\end{proof}

\begin{example}
    Soit $f$ la fonction définie par 
    \begin{align}
        f(x) = x^4 + \sqrt x.
    \end{align}
    Pour tout $x \in \R_0^+$, on a 
    \begin{align}
        f'(x) = 4x^3 + \frac{1}{2\sqrt x}.
    \end{align}
\end{example}

\begin{example}
    [Dérivée de $f(x) + k$]
    Soit $f$ une fonction dérivable en $a \in \R$.
    Soit $k \in \R$ une constante. 
    La fonction $f + k$ est dérivable en $a$ et on a 
    \begin{align}
        (f + k)'(a) = f'(a) + 0 = f'(a).
    \end{align}
\end{example}

\begin{proposition}
    [Dérivée d'une différence]

    Soient $f, g$ deux fonctions dérivables en $a \in \R$.
    Alors $f - g$ est dérivable en $a$ et
    \begin{align}
        (f - g)'(a) = f'(a) - g'(a).
    \end{align}
\end{proposition}

\begin{example}
    Soit $f$ la fonction définie par 
    \begin{align}
        f(x) = \frac{1}{x} - \cos x.
    \end{align}
    Pour tout $x \in \R_0$, on a 
    \begin{align}
        f'(x) = -\frac{1}{x^2} + \sin x.
    \end{align}
\end{example}

\begin{proposition}
    [Dérivée d'un produit]

    Soient $f, g$ deux fonctions dérivables en $a \in \R$.
    Alors $f g$ est dérivable en $a$ et
    \begin{align}
        (f g)'(a) = f'(a) g(a) + f(a) g'(a).
    \end{align}
\end{proposition}
\begin{proof}
    Soit $x \in \dom f \setminus \{a\}$.
    Le quotient différentiel de $f g$ s'écrit
    \begin{align}
        \frac {(f g)(x) - (f g)(a)} {x - a}
        &= \frac {f(x) g(x) - f(a) g(a)} {x - a}\\
        &= \frac {f(x) g(x) - f(a) g(x) + f(a) g(x) - f(a) g(a)} {x - a}\\
        &= \left(\frac {f(x) - f(a)} {x - a}\right) g(x) + f(a) \left(\frac {g(x) - g(a)} {x - a}\right).
    \end{align}

    En faisant tendre $x$ vers $a$ des deux côtés,
    on obtient
    \begin{align}
        (f g)'(a) = f'(a) g(a) + f(a) g'(a).
    \end{align}
\end{proof}

\begin{example}
    Soit $f$ la fonction définie par 
    \begin{align}
        f(x) = x^2 \sin x.
    \end{align}
    Pour tout $x \in \R_0^+$, on a 
    \begin{align}
        f'(x) = 2x \cdot \sin x + x^2 \cdot \cos x.
    \end{align}
\end{example}

\begin{example}
    [Dérivée de $k f(x)$]
    Soit $f$ une fonction dérivable en $a \in \R$.
    Soit $k \in \R$ une constante. 
    La fonction $kf$ est dérivable en $a$ et on a 
    \begin{align}
        (kf)'(a) = 0 \cdot f(a) + k \cdot f'(a) = kf'(a).
    \end{align}
\end{example}

\begin{proposition}
    [Dérivée d'une composée]

    \subsubsection{Hypothèses}

    \begin{enumerate}
        \item $f$ une fonction dérivable en $a$;
        \item $g$ une fonction dérivable en $f(a)$.
    \end{enumerate}

    \subsubsection{Thèse}

    Alors $g \circ f$ est dérivable en $a$ et
    \begin{align}
        (g \circ f)'(a) = g'(f(a)) f'(a).
    \end{align}
\end{proposition}
\begin{proof}[Preuve lorsque $f$ est injective]
    Soit $x \in \dom f \setminus \{a\}$.
    Le quotient différentiel de $g \circ f$ s'écrit
    \begin{align}
        \frac {(g \circ f)(x) - (g \circ f)(a)} {x - a}
        &= \frac {g(f(x)) - g(f(a))} {x - a}\\
        &= \frac {g(f(x)) - g(f(a))} {f(x) - f(a)} \frac {f(x) - f(a)} {x - a}.
    \end{align}
    Notons que l'hypothèse d'injectivité nous assure qu'il n'y a pas de division par $0$.

    En faisant tendre $x$ vers $a$ des deux côtés,
    et en se souvenant qu'alors $f(x)$ tend vers $f(a)$ par continuité,
    on obtient
    \begin{align}
        (g \circ f)'(a) = g'(f(a)) f'(a).
    \end{align}
\end{proof}

\begin{example}
    Soit $f$ la fonction définie par 
    \begin{align}
        f(x) = \sin (4x + 1).
    \end{align}
    Pour tout $x \in \R$, on a 
    \begin{align}
        f'(x) = \cos (4x + 1) \cdot (4x + 1)' = 4\cos (4x + 1).
    \end{align}
\end{example}

\begin{proposition}
    [Dérivée d'un quotient]

    \subsubsection{Hypothèses}

    \begin{itemize}
        \item $f, g$ deux fonctions dérivables en $a \in \R$.
        \item $g'(a) \neq 0$.
    \end{itemize}

    \subsubsection{Thèse}

    Le quotient $\frac f g$ est dérivable en $a$ et
    \begin{align}
        \left(\frac f g\right)'(a) = \frac {f'(a) g(a) - f(a) g'(a)} {g^2(a)}
    \end{align}
\end{proposition}
\begin{proof}
    Soit $x \in \dom f \setminus \{a\}$.
    Clairement,
    on a
    \begin{align}
        \left(\frac f g\right)'(a)
        = \left(f \frac 1 g\right)'(a)
        = f'(a) \frac 1 {g(a)} + f(a) \left(\frac 1 g\right)'(a).
    \end{align}

    Il ne reste plus qu'à calculer la dérivée de $\frac 1 g$.
    Pour ce faire,
    si nous dénotons par $\iota(a) = \frac 1 a$ la fonction inverse
    alors $\frac 1 g = \iota \circ g$ et la dérivée vaut
    \begin{align}
        \left(\frac 1 g\right)'(a) = \iota'(g(a)) g'(a) = \frac {-g'(a)} {g^2(a)}.
    \end{align}

    En combinant tout,
    nous obtenons
    \begin{align}
        \left(\frac f g\right)'(a)
        &= f'(a) \frac 1 {g(a)} - f(a) \frac {g'(a)} {g^2(a)}\\
        &= \frac {f'(a) g(a) - f(a) g'(a)} {g^2(a)}
    \end{align}
\end{proof}

\begin{example}
    Soit $f$ la fonction définie par 
    \begin{align}
        f(x) = \frac{x^3 - 1}{x^2 + 2}.
    \end{align}
    Pour tout $x \in \R$, on a 
    \begin{align}
        f'(x) 
        &= \frac{3x^2 \cdot (x^2 + 2) - (x^3 - 1) \cdot 2x}{(x^2 + 2)^2}\\
        &= \frac{x^4 + 6 x^2 + 2x}{(x^2 + 2)^2}.
    \end{align}
\end{example}

\begin{exercise}
    Calculer la dérivée des fonctions tangente et cotangente.
\end{exercise}

\subsection{Recherche d'extrémums locaux}

La connaissance de la dérivée d'une fonction facilite grandement la recherche des maximums et minimums locaux de la fonction.

Commençons par définir ces deux notions.

\begin{definition}
    [Extremums locaux]

    \subsubsection{Cadre}

    \begin{itemize}
        \item $f$ une fonction.
        \item $a \in \dom f$.
    \end{itemize}

    \subsubsection{Définition}

    On dit que $f$ admet un \emph{maximum} (resp.\ \emph{minimum}) \emph{local} en $a$ si
    pour tout $x \in \dom f$ \emph{suffisamment proche} de $a$,
    \begin{align}
        f(a) \ge f(x) \quad \left(\text{resp.}\ f(a) \le f(x)\right)
    \end{align}

    \begin{plot}
        {0.5}{-4}{-3}{6}{5}
        \def\f{-0.2*(\x - 1)^2 + 3}
        \plotfunction{-6:6}{\f}
        \showcoordinates{\f}{1}{[below] {$a$}}{[left] {$f(a)$}}
        \showcoordinates{\f}{4}{[below] {$x$}}{[left] {$f(x)$}}
    \end{plot}
\end{definition}

La proposition suivante permet de sélectionner les points qui ont une chance d'être des extremums locaux.

\begin{proposition}
    [Théorème de Fermat]

    \subsubsection{Hypothèses}

    \begin{itemize}
        \item $f$ est une fonction dérivable en $a \in \R$
        \item $f$ admet un extremum local en $a$;
    \end{itemize}

    \subsubsection{Thèse}

    On a $f'(a) = 0$.

    \begin{plot}{0.3}{-6}{-6}{6}{6}
        \def\f{-1/5*(\x)^2 + 2}
        \def\der{-2/5*(\x)}
        \plotfunction{-6:6}{\f}
        \drawtangent{\f}{\der}{0}{-2:2}
    \end{plot}
\end{proposition}
\begin{proof}
    Supposons que $a$ est un maximum local de $f$.
    Soit $x \in \dom f$.

    \begin{multicols}{2}
        Si $x$ est \emph{suffisamment proche} de $a$ avec $x < a$,
        alors on en déduit que
        \begin{align}
            \frac{f(x) - f(a)}{x-a} \ge 0,
        \end{align}
        ce qui, en faisant tendre $x$ vers $a$, devient
        \begin{align}
            f'(a) \ge 0.
        \end{align}

        Si $x$ est \emph{suffisamment proche} de $a$ avec $x > a$,
        alors on en déduit que
        \begin{align}
            \frac{f(x) - f(a)}{x-a} \le 0,
        \end{align}
        ce qui, en faisant tendre $x$ vers $a$, devient
        \begin{align}
            f'(a) \le 0.
        \end{align}
    \end{multicols}

    On en conclut donc que
    \begin{align}
        f'(a) = 0.
    \end{align}
    La démonstration est similaire si $a$ est un minimum local de $f$.
\end{proof}

Il faut faire bien attention au fait que la réciproque de ce théorème est fausse.
En effet, l'exemple suivant montre qu'on peut avoir $f'(a) = 0$ sans avoir d'extremum local en $a$.

\begin{example}
    Considérons la fonction $f$ définie par
    \begin{align}
        f(x) = \frac 1 {20} x^3.
    \end{align}
    La dérivée de cette fonction est la fonction
    \begin{align}
        f'(x) = \frac 3 {20} x^2.
    \end{align}
    On constate que $f'(0) = 0$.
    Cependant, la fonction $f$ n'admet pas d'extremum local en $0$,
    comme le montre le graphe ci-dessous.

    \begin{plot}{0.3}{-6}{-6}{6}{6}
        \def\f{1/20*(\x)^3}
        \def\der{3/20*(\x)^2}
        \plotfunction{-6:6}{\f}
        \drawtangent{\f}{\der}{0}{-2:2}
    \end{plot}
\end{example}

Pour déterminer si les racines de la dérivée correspondent effectivement à des extremums locaux,
on va étudier plus en détail la croissance de la fonction.
Heureusement, la dérivée joue également un rôle majeur dans cette étude.

\section{Dérivée et croissance}

Rappelons qu'une fonction $f$ est croissante (resp.\ décroissante) sur un intervalle $I$
si le \emph{taux d'accroissement} entre deux points distincts $a \in I$ et $b \in I$
\begin{align}
    \frac {f(b) - f(a)} {b - a}
\end{align}
est toujours \emph{positif} (resp.\ \emph{négatif}).

La \emph{croissance} est liée à la dérivée via le théorème suivant.

\begin{proposition}
    [Théorème des accroissements finis]

    \subsubsection{Hypothèses}

    \begin{itemize}
        \item $f$ une fonction dérivable sur un intervalle $I$.
        \item $a,b \in I$ deux points distincts.
    \end{itemize}
    \subsubsection{Thèse}

    Il existe $c$ entre $a$ et $b$ tel que
    \begin{align}
        \frac {f(b) - f(a)} {b - a} = f'(c).
    \end{align}
\end{proposition}

\begin{remark}
    [Interprétation des accroissements finis]

    La formule
    \begin{align}
        \frac {f(b) - f(a)} {b - a} = f'(c).
    \end{align}
    signifie que la tangente en $c$
    est parallèle à la sécante passant par $(a, f(a))$ et $(b, f(b))$
    comme ci-dessous.

    \begin{plot}{0.5}{-6}{-2}{6}{6}
        \def\a{-3}
        \def\b{3}
        \def\c{1.25}
        \def\f{e^(\x - 2) + 1}
        \def\der{e^(\x - 2)}
        \plotfunction{-6:6}{\f}
        \drawsecant{\f}{\a}{\b}{-6:6}
        \drawtangent{\f}{\der}{\c}{0:2.5}
        \showxcoordinates{\f}{\a}{[below] {$a$}}
        \showxcoordinates{\f}{\b}{[below] {$b$}}
        \showxcoordinates{\f}{\c}{[below] {$c$}}
    \end{plot}
\end{remark}

\begin{proof}[Ébauche de preuve]
    Définissons la fonction
    \begin{align}
        g(x) = f(x) - \frac {f(b) - f(a)} {b - a} (x - a).
    \end{align}

    On vérifie que $g(a) = g(b)$ par choix de $g$.
    On en déduit que $g$ atteint un extremum entre $a$ et $b$,
    disons en $c$.
    On a donc $g'(c) = 0$ par le théorème de Fermat.

    Cependant,
    \begin{align}
        g'(x) = f'(x) - \frac {f(b) - f(a)} {b - a}
    \end{align}
    de telle sorte que $g'(c) = 0$ s'écrit
    \begin{align}
        0 = f'(c) - \frac {f(b) - f(a)} {b - a}.
    \end{align}
\end{proof}

\begin{proposition}
    \subsubsection{Hypothèse}
    Soit $f$ une fonction dérivable sur un intervalle $I$.

    \subsubsection{Thèse}
    \begin{itemize}
        \item $f$ est \emph{croissante} sur $I$
            si et seulement si $f'$ est \emph{positive} sur $I$.
        \item $f$ est \emph{décroissante} sur $I$
            si et seulement si $f'$ est \emph{négative} sur $I$.
    \end{itemize}

    \begin{plot}
        {0.5}{-6}{-2}{3}{6}
        \def\f{e^(\x) - 1}
        \def\der{e^(\x)}
        \plotfunction{-6:3}{\f}
        \drawtangent{\f}{\der}{1}{0.75:1.25}
        \drawtangent{\f}{\der}{0}{-0.75:0.75}
        \drawtangent{\f}{\der}{-2}{-3:-1}
    \end{plot}
\end{proposition}
\begin{proof}
    Supposons que la fonction $f$ est croissante.
    Soit $a \in I$.
    Pour $ I \setminus \{a\}$, on a
    \begin{align}
        \frac{f(x) - f(a)}{x - a} \ge 0.
    \end{align}
    On a donc
    \begin{align}
        f'(a) \ge 0.
    \end{align}

    Dans l'autre sens, supposons que $f'$ est positive sur $I$.
    Prenons $a,b \in I$ deux points distincts.
    Par le théorème des accroissements finis,
    il existe $c$ entre $a$ et $b$ tel que
    \begin{align}
        \frac{f(b) - f(a)}{b - a} = f'(c).
    \end{align}
    Puisque $f'$ est positive partout sur $I$,
    on en déduit que $f$ est croissante.

    Le cas où $f$ est décroissante est similaire.
\end{proof}

\begin{howto}
    [Étude de croissance]

    \begin{enumerate}
        \item Conditions d'existence et calcul du domaine.
        \item Calcul de la dérivée.
        \item Tableau de signe de la dérivée.
        \item En déduire la croissance.
    \end{enumerate}
\end{howto}

L'exemple suivant éclaire la marche à suivre.

\begin{example}
     Soit $f$ la fonction définie par
     \begin{align}
         f(x) = x^5 - \frac {10} 3 x^3.
     \end{align}
     Il n'y a aucune condition d'existence donc $\dom f = \R$.

     Pour tout $x \in \R$, on a
     \begin{align}
         f'(x)
         &= 5 x^4 - 10 x^2\\
         &= 5 x^2 (x^2 - 2).
     \end{align}

     Le tableau de signe de $f'$ nous permet d'étudier les variations de $f$.

     \signtable{$x$/0.75, $5 x^2$/0.75, $x^2 - 2$/0.75, $f'(x)$/0.75, $f(x)$/2}{,$- \sqrt{2}$,$0$,$\sqrt{2}$,}{%
        \signrow{,+,+,+,0,+,+,+,}
        \signrow{,+,0,-,-,-,0,+,}
        \signrow{,+,0,-,0,-,0,+,}
        \tkzTabVar{-/ $-\infty$, +/ $\frac{8\sqrt{2}}{3}$, R/, -/ $- \frac{8\sqrt{2}}{3}$, +/ $+\infty$}
        \tkzTabIma{2}{4}{3}{$0$}
    }

    On constate que $f$ admet un maximum local en $- \sqrt 2$ et un minimum local en $ \sqrt 2$.
    La dérivée s'annule en $0$ mais il n'y a pas d'extremum local en ce point.

    Voici le graphique de $f$ qui confirme nos résultats :

    \begin{plot}{0.5}{-5}{-5}{5}{5}
        \plotfunction{-5:5}{(\x)^5 - (10/3)*(\x)^3}
    \end{plot}
\end{example}

Dans l'exemple suivant, on revisite une formule vue l'an passé.

\begin{example}
    [Sommet d'une parabole]

    Soit $f$ la fonction du deuxième degré
    \begin{align}
        f(x) = a x^2 + bx + c
    \end{align}
    avec $a \neq 0$.

    Pour tout $x \in \R$, on a
    \begin{align}
        f'(x) = 2ax + b.
    \end{align}
    L'unique racine de $f'$ est $x = - \frac{b}{2a}$.
    Par le théorème de Fermat, l'abscisse du sommet de $f$ est donc $- \frac{b}{2a}$.
\end{example}

\section{Dérivée seconde, convexité et points d'inflexion}

Pour étudier la convexité d'une fonction $f$, on étudie le \emph{signe} de sa \emph{dérivée seconde}.

\begin{definition}
    [Dérivée seconde]
    
    \subsubsection{Cadre}

    \begin{itemize}
        \item $f$ est une fonction dérivable.
        \item $f'$ est également dérivable.
    \end{itemize}

    \subsubsection{Définition}

    La dérivée de $f'$\footnote{%
        Si vous aimez embêter vos profs de français avec des répétitions,
        c'est la dérivée de la dérivée de $f$.
    } est appelée \emph{dérivée seconde} de $f$,
    que l'on notera $f''$.
\end{definition}

Si la dérivée seconde de $f$ existe sur un intervalle $I$,
on dit que $f$ est \emph{deux fois dérivable} sur $I$.

\begin{definition}
    [Convexité pour les paresseux]

    \subsubsection{Cadre}
    Soit $f$ une fonction deux fois dérivable sur un intervalle $I$.

    \subsubsection{Définition}
    \begin{itemize}
        \item $f$ est \emph{convexe} sur $I$ si et seulement si $f'' \ge 0$ sur $I$;
        \item $f$ est \emph{concave} sur $I$ si et seulement si $f'' \ge 0$ sur $I$.
    \end{itemize}
\end{definition}

\begin{remark}
    [La convexité pour les nuls]

    Une fonction $f$ est:
    \begin{itemize}
        \item \emph{convexe} si son graphique ressemble à la bouche d'un smiley content\footnote{ou à la bouche de M. Nguyen lorsqu'il y a à manger devant lui}.
        \item \emph{concave} si son graphique ressemble à la bouche d'un smiley fâché\footnote{ou à la bouche de M. Bertrand quand il regarde un match du Standard de Liège.}.
    \end{itemize}
\end{remark}

\begin{definition}
    [Point d'inflexion]
    
    Soit $f$ une fonction.
    Soit $a \in \dom f$.
    On dit que $f$ admet un \emph{point d'inflexion} en $a$ si la convexité de $f$ change en $a$\footnote{elle passe de convexe à concave ou de concave à convexe}.
\end{definition}

Reprenons l'étude de fonction de la section précédente afin de la compléter.

\begin{example}
     Soit $f$ la fonction définie par
     \begin{align}
         f(x) = x^5 - \frac {10} 3 x^3.
     \end{align}

     On avait calculé, pour tout $x \in \R$,
     \begin{align}
         f'(x) = 5 x^4 - 10 x^2
     \end{align}

     En redérivant, on trouve, pour tout $x \in \R$,
     \begin{align}
         f''(x) 
         &= 20 x^3 - 20 x\\
         &= 20x (x^2 - 1).
     \end{align}
     
     Cette fois, on étudie le signe de $f''$.

     \signtable{$x$/0.75, $20 x$/0.75, $x^2 - 1$/0.75, $f''(x)$/0.75}{,$-1$,$0$,$1$,}{%
        \signrow{,-,-,-,0,+,+,+,}
        \signrow{,+,0,-,-,-,0,+,}
        \signrow{,-,0,+,0,-,0,+,}
    }

    On constate que $f$ est convexe sur $\ccinterval{-1}{0}$ et sur $\cointerval{1}{+ \infty}$ et
    que $f$ est concave sur $\ocinterval{- \infty}{-1}$ et sur $\ccinterval{0}{1}$.
    La fonction $f$ admet trois points d'inflexion en $-1$, $0$, et $1$.

    (Re)Voici le graphique de $f$ qui (re)confirme nos résultats :

    \begin{plot}{0.5}{-5}{-5}{5}{5}
        \plotfunction{-5:5}{(\x)^5 - (10/3)*(\x)^3}
    \end{plot}
\end{example}

\end{document}
